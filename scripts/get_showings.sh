#!/usr/bin/env bash
curl -s 'https://www.glasgowfilm.org/graphql' --compressed -X POST -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:122.0) Gecko/20100101 Firefox/122.0' -H 'Accept: */*' -H 'Accept-Language: en-GB,en;q=0.5' -H 'Accept-Encoding: gzip, deflate' -H 'content-type: application/json' -H 'site-id: 103' -H 'client-type: consumer' -H 'Origin: https://www.glasgowfilm.org' -H "Cookie:  ${COOKIE}" -H 'Sec-Fetch-Dest: empty' --data-raw '{"operationName":null,"variables":{"ids":[],"movieId":"'$1'","movieIds":[],"titleClassId":null,"titleClassIds":null,"anyShowingBadgeIds":null,"everyShowingBadgeIds":[null],"skip":false,"resultVersion":null},"query":"query ($date: String, $ids: [ID], $movieId: ID, $movieIds: [ID], $titleClassId: ID, $titleClassIds: [ID], $everyShowingBadgeIds: [ID], $anyShowingBadgeIds: [ID], $resultVersion: String) { showingsForDate( date: $date ids: $ids movieId: $movieId movieIds: $movieIds titleClassId: $titleClassId titleClassIds: $titleClassIds everyShowingBadgeIds: $everyShowingBadgeIds anyShowingBadgeIds: $anyShowingBadgeIds resultVersion: $resultVersion ) { data { id time showingId ticketsSold screenId movie { id name showingStatus displayMetaData urlSlug posterImage bannerImage synopsis starring directedBy producedBy duration genre allGenres rating ratingReason trailerYoutubeId releaseDate titleClassId } showing { id time showingId ticketsSold screenId movie { id name showingStatus displayMetaData urlSlug posterImage bannerImage synopsis starring directedBy producedBy duration genre allGenres rating ratingReason trailerYoutubeId releaseDate titleClassId } seatsRemaining } showings { id time showingId ticketsSold screenId movie { id name showingStatus displayMetaData urlSlug posterImage bannerImage synopsis starring directedBy producedBy duration genre allGenres rating ratingReason trailerYoutubeId releaseDate titleClassId } seatsRemaining } showingBadgeIds seatsRemaining } count } } "}' | jq '.data.showingsForDate.data[]'
